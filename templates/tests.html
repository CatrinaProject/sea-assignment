<!DOCTYPE html>
<html>
<head>
    <title>Test Records</title>
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
    </style>
    <script>
        function validateInput(inputElement) {
            var validCharsPattern = /^[a-zA-Z0-9\s\-.,']+$/; 
            var errorMessageElement = document.getElementById('error-message');
            var addRecordButton = document.getElementById('add-record-button');
            
            if (!validCharsPattern.test(inputElement.value) || inputElement.value.length > 50) {
                errorMessageElement.textContent = 'Invalid characters or too long (max 50 characters).';
                addRecordButton.disabled = true;
            } else {
                errorMessageElement.textContent = '';
                addRecordButton.disabled = false;
            }
        }

        function validateDuration(inputElement) {
            var durationValue = inputElement.value;
            var errorMessageElement = document.getElementById('error-message');
            var addRecordButton = document.getElementById('add-record-button');
            
            // Regular expression to match valid decimal numbers with up to 5 digits and 3 decimal places
            var decimalRegex = /^\d{1,5}(\.\d{1,2})?$/;
            
            if (!decimalRegex.test(durationValue) || durationValue <= 0) {
                errorMessageElement.textContent = 'Invalid Decimal or Maximum of 2 decimal places';
                addRecordButton.disabled = true;
            } else {
                errorMessageElement.textContent = '';
                addRecordButton.disabled = false;
            }
        }
    </script> 
</head>
<body>
    <h2>Test Records</h2>
    <table>
        <tr>
            <th>Test ID</th>
            <th>Test Name</th>
            <th>Duration</th>
            <th>Region</th>
            <th>Audio Test Type</th>
            <th>Playback Type</th>
            <th>Test Criteria</th>
            <th>Test Parameters</th>
            <th>Actions</th>
        </tr>
        {% for test in test_cases %}
            <tr>
                <td>{{ test[0] }}</td>
                <td>{{ test[1] }}</td>
                <td>{{ test[2] }}</td>
                <td>{{ test[3] }}</td>
                <td>{{ test[4] }}</td>
                <td>{{ test[5] }}</td>
                <td>{{ test[6] }}</td>
                <td>{{ test[7] }}</td>
                <td class="actions">
                    <a href="/admin/tests/edit?test_id={{ test[0] }}">Edit</a>
                    <a href="/admin/tests/delete?test_id={{ test[0] }}">Delete</a>
                </td>
            </tr>
        {% endfor %}
    </table>
    <div id="error-message" style="color: red;"></div>
    <form method="post" action="/tests/add">
        <label for="test_name">Test Name:</label>
        <input type="text" name="test_name" value="{{ test_name }}" required oninput="validateInput(this)"><br>
        <label for="duration">Duration:</label>
        <input type="text" name="duration" value="{{ duration }}" required oninput="validateDuration(this)"><br>
        <label for="region">Region:</label>
        <input type="text" name="region" value="{{ region }}" required oninput="validateInput(this)"><br>
        <label for="audio_test_type">Audio Test Type:</label>
        <input type="text" name="audio_test_type" value="{{ audio_test_type }}" required oninput="validateInput(this)"><br>
        <label for="playback_type">Playback Type:</label>
        <input type="text" name="playback_type" value="{{ playback_type }}" required oninput="validateInput(this)"><br>
        <label for="test_criteria">Test Criteria:</label>
        <input type="text" name="test_criteria" value="{{ test_criteria }}" required oninput="validateInput(this)"><br>
        <label for="test_parameters">Test Parameters:</label>
        <input type="text" name="test_parameters" value="{{ test_parameters }}" required oninput="validateInput(this)"><br>
        <button type="submit" id="add-record-button">Add new record</button>
    </form>
</body>
</html>
